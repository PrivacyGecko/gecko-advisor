# Gecko Advisor Environment Configuration
# Copy this file to .env and update with your actual values

#######################################
# ENVIRONMENT
#######################################

# Application environment: development, stage, or production
APP_ENV=development

# Node environment: development, production, or test
NODE_ENV=development

#######################################
# DATABASE
#######################################

# PostgreSQL connection string
# Format: postgresql://[user]:[password]@[host]:[port]/[database]
DATABASE_URL=postgresql://postgres:postgres@localhost:5432/privacy

#######################################
# REDIS
#######################################

# Redis connection string for BullMQ job queue
REDIS_URL=redis://localhost:6379

#######################################
# PORTS
#######################################

# Backend API server port (default: 5000)
BACKEND_PORT=5000

# Worker health check port (default: 5050)
WORKER_HEALTH_PORT=5050

#######################################
# PUBLIC URLS
#######################################

# Frontend public URL (for CORS and CSP)
FRONTEND_PUBLIC_URL=http://localhost:8080

# Backend API public URL (for CORS and CSP)
BACKEND_PUBLIC_URL=http://localhost:5000

# Worker public URL (for CORS and CSP)
WORKER_PUBLIC_URL=http://localhost:5050

# For stage/production, set the primary origin
# STAGE_ORIGIN=https://stage.yourdomain.com
# ALLOW_ORIGIN=https://yourdomain.com

#######################################
# CORS & SECURITY
#######################################

# Additional origins for CORS (comma-separated)
# CORS_EXTRA_ORIGINS=https://app.example.com,https://admin.example.com

# CSP report URI (optional, for Content Security Policy violation reporting)
# CSP_REPORT_URI=https://yourdomain.com/api/csp-report

#######################################
# ADMIN ACCESS
#######################################

# Admin API key for privileged endpoints (e.g., /api/admin/refresh-lists)
# Generate a strong random key: openssl rand -hex 32
ADMIN_API_KEY=your-admin-key-here

#######################################
# CLOUDFLARE TURNSTILE (Optional)
# Bot protection for scan endpoints
#######################################

# Backend: Enable Cloudflare Turnstile bot protection
TURNSTILE_ENABLED=false

# Backend: Turnstile secret key (server-side verification)
# Get from: https://dash.cloudflare.com/turnstile
# TURNSTILE_SECRET_KEY=1x0000000000000000000000000000000AA

# Frontend: Turnstile site key (visible in browser)
# This must start with VITE_ to be exposed to frontend
# Get from: https://dash.cloudflare.com/turnstile
# VITE_TURNSTILE_SITE_KEY=1x00000000000000000000AA

# Turnstile verification endpoint (default: Cloudflare)
# TURNSTILE_VERIFY_URL=https://challenges.cloudflare.com/turnstile/v0/siteverify

#######################################
# OBJECT STORAGE (Optional)
# S3-compatible storage for report archival
#######################################

# Enable object storage for archiving scan reports
OBJECT_STORAGE_ENABLED=false

# S3-compatible endpoint URL
# Examples:
#   AWS S3: https://s3.us-east-1.amazonaws.com
#   Hetzner: https://project-name.s3.eu-central-1.hetzner.com
#   MinIO: https://minio.yourdomain.com
# OBJECT_STORAGE_ENDPOINT=https://your-bucket.s3.region.amazonaws.com

# Storage region (e.g., us-east-1, eu-central-1)
OBJECT_STORAGE_REGION=us-east-1

# Bucket name for storing reports
# OBJECT_STORAGE_BUCKET=geckoadvisor-reports

# Access key ID for S3 authentication
# OBJECT_STORAGE_ACCESS_KEY=your-access-key-id

# Secret access key for S3 authentication
# OBJECT_STORAGE_SECRET_KEY=your-secret-access-key

# Public URL for CDN access (optional)
# If using CloudFront or other CDN, set this to the CDN URL
# OBJECT_STORAGE_PUBLIC_URL=https://cdn.yourdomain.com

# Prefix for report files (default: reports/)
OBJECT_STORAGE_REPORT_PREFIX=reports/

# Force path-style URLs (required for some providers like MinIO)
OBJECT_STORAGE_FORCE_PATH_STYLE=true

# Signed URL expiry in seconds (default: 3600 = 1 hour)
OBJECT_STORAGE_SIGNED_URL_SECONDS=3600

#######################################
# WORKER CONFIGURATION
#######################################

# Number of concurrent scan jobs (default: 5)
# Higher values increase throughput but use more resources
WORKER_CONCURRENCY=5

# Number of retry attempts for failed jobs (default: 3)
WORKER_JOB_ATTEMPTS=3

# Backoff delay between retries in milliseconds (default: 5000)
WORKER_BACKOFF_MS=5000

# Request timeout for HTTP requests in milliseconds (default: 5000)
WORKER_REQUEST_TIMEOUT_MS=5000

# Maximum content size to fetch in bytes (default: 800000 = 800KB)
WORKER_MAX_CONTENT_BYTES=800000

# Crawl time budget in milliseconds (default: 10000 = 10 seconds)
WORKER_CRAWL_BUDGET_MS=10000

# Maximum pages to crawl per scan (default: 10)
WORKER_PAGE_LIMIT=10

# Job timeout in milliseconds (default: 60000 = 60 seconds)
# Includes crawling, scoring, and database operations
WORKER_JOB_TIMEOUT_MS=60000

#######################################
# RATE LIMITING
#######################################

# Cache TTL in milliseconds (default: 900000 = 15 minutes)
# CACHE_TTL_MS=900000

#######################################
# LOGGING
#######################################

# Log level: debug, info, warn, error (default: debug in dev, info in prod)
# LOG_LEVEL=info

#######################################
# MONITORING (Optional)
#######################################

# Sentry DSN for backend error tracking
# SENTRY_DSN_BE=https://your-sentry-dsn-here@sentry.io/project-id

# Sentry DSN for worker error tracking
# SENTRY_DSN_WORKER=https://your-sentry-dsn-here@sentry.io/project-id

# Sentry traces sample rate (0.0 to 1.0, default: 0.05 = 5%)
# SENTRY_TRACES_SAMPLE_RATE=0.05


#######################################
# DEVELOPMENT TOOLS
#######################################

# Use test fixtures for .test domains (for deterministic testing)
# USE_FIXTURES=1
